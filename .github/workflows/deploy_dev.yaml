name: Deploy Dev

on:
  workflow_run: 
    workflows: [Main Build]
    types:
      - completed

jobs:
  deploy_dev:
    if: ${{ github.event.workflow_run.conclusion == 'success' }}
    uses: ./.github/workflows/deploy_env.yaml@main
    with:
      target-env: dev

    secrets:
      auth0-client-id: ${{ secrets.DEV_AUTH0_CLIENT_ID }}
      auth0-client-secret: ${{ secrets.DEV_AUTH0_CLIENT_SECRET }}
      auth0-domain: ${{ secrets.DEV_AUTH0_DOMAIN }}
      arm-client-id: ${{ secrets.ARM_CLIENT_ID }}
      arm-client-secret: ${{ secrets.ARM_CLIENT_SECRET }}
      arm-subscription-id: ${{ secrets.ARM_SUBSCRIPTION_ID }}
      arm-tenant-id: ${{ secrets.ARM_TENANT_ID }}
      pulumi-config-passphrase: ${{ secrets.PULUMI_CONFIG_PASSPHRASE }}